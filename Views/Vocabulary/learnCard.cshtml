@model  KhoaLuanTotNghiep.Models.THONGTINTAIKHOAN
@using KhoaLuanTotNghiep.Models;

@{
    ViewBag.Title = "learnCard";
    Layout = "~/Views/Shared/_Layout.cshtml";
    Model1 model = new Model1();
    var tuple = ViewData["tuple"] as Tuple<List<TUVUNGONTAP>, int>;
    var account = model.TAIKHOANs.Where(t => t.USING == true).SingleOrDefault();
    var chudeyeuthich = model.CHUDEs.Where(t => t.IDTK1 == account.IDTK).SingleOrDefault();
    var listtv = tuple.Item1;
}
<head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=G9wc7rFf"></script>
    <link rel="stylesheet" type="text/css" href="~/Content/style.css" media="screen" />
    <style>
        .vocabulary a {
            background-color: rgba(0, 0, 0,0.2);
        }
        body {
            background-image: url(https://kidsgoflash.com/wp-content/uploads/2017/02/kidsgoflash_sky_birds2.jpg);
            background-color: rgba(255,255,255,0.7);
            background-blend-mode: screen;
            background-position: center top;
            background-size: cover;
            background-repeat: no-repeat;
        }
       
        #finish {
            background-color: rgb(204, 0, 0);
        }

            #finish:hover {
                text-decoration: none;
                background-color: rgb(255, 0, 0);
            }

        #practiceCard {
            background-color: rgb(0, 153, 51);
        }

            #practiceCard:hover {
                background-color: rgb(0, 230, 77);
                text-decoration: none;
            }
    </style>
</head>

<div class="learn-container" style="width:1240px;height:645px;margin-top:50px;margin-left:15px;display:flex;flex-direction:row;">
    <div class="board-control" style="height:100%;width:60%;margin-left:50%;transform:translateX(-50%);border-radius:2rem;background-color:rgba(251, 248, 226,0.7);position:relative;padding:50px;position:relative;">
        <div class="img-container" style="overflow:hidden;background-color:white;width:65%;height:90%;border-radius:2rem;box-shadow:0 0 10px grey;">
            @foreach (var item in listtv)
            {
                <div id="@item.IDTV" class="@item.TENTV" style="height:100%;width:100%;padding:20px;">
                    <div class="img-item" style="height:100%;">
                        <div class="img" style="height:85%;border-radius:2rem;background-image:url('@item.ANHTUVUNG');background-repeat:no-repeat;background-size:100% 100%;position:relative;display:flex;flex-direction:row;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="sound" style="width: 10%; height: 10%; margin-left: 10%; margin-top: 2%;" fill="currentColor" class="bi bi-volume-up-fill" viewBox="0 0 16 16">
                                <path d="M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z" />
                                <path d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z" />
                                <path d="M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z" />
                            </svg>
                            @if (model.TUVUNGONTAPs.Where(t => t.IDCD == chudeyeuthich.IDCD).Where(t => t.TENTV.ToLower().Equals(item.TENTV)).ToList().Count() == 0)
                            {
                                <svg class="star" style="width:10%;height:10%;margin-left:60%;margin-top:2%;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">
                                    <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                                </svg>
                            }
                            else
                            {
                                <svg class="star" style="width:10%;height:10%;margin-left:60%;margin-top:2%;color:rgb(255, 237, 38);" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">
                                    <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                                </svg>
                            }

                        </div>
                        <div class="@item.TENTV" style="height:65px;display:flex;justify-content:center;align-items:center;text-align:center;">
                            <h1  class="@item.TENTV" style="font-size:2rem;margin-top:20px;text-transform:capitalize">@item.TENTV : @item.NGHIATV</h1>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="previous-next" style="width:50%;height:80px;margin-left:50px;display:flex;align-items:center;margin-top:10px;justify-content:space-around;">
            <div class="previous" style="width:35%;height:100%;background-image:url(../../Img/button/previous.png);background-size:100% 100%;">
                
            </div>
            <div class="next" style="width:35%;height:100%;background-image:url(../../Img/button/next.png);background-size:100% 100%;" >

            </div>

        </div>
        <div class="info" style=" position:absolute;height:75%;top:50px;left:67%;width:30%;text-align:center;padding-top:20px;" >
            <h3 >1 / @listtv.Count()</h3>

            <div class="amount" style="border:1px solid grey;height:20px;">
                <div class="liquid" style="height:100%; background-color:rgb(0, 38, 153);transition:all .5s;"></div>
            </div>

            <div class="play-pause-stop" style="margin-top:30px;height:300px;display:flex;flex-direction:column;justify-content:space-around;align-items:center;">
                <img class="play-pause" src="~/Img/button/start.png" alt="Alternate Text" style="width:50%;"/>
                <img class="stop" src="~/Img/stop1.png" alt="Alternate Text" style="width:50%;" />
            </div>
            <div class="close-practice" style="margin-top: 75px; display:flex;flex-direction:column;height:100px;justify-content:space-around;align-items:center;">
                @Html.ActionLink("Luyện tập", "practice", "Vocabulary", new { id = tuple.Item2 }, new { @id = "practiceCard", @style = "padding:5px 5px;font-weight:600;border-radius:2rem;height:40%;color:white;width:80%;" })
                @Html.ActionLink("Kết thúc", "details", "Vocabulary",new { id = tuple.Item2}, new { @id = "finish", @style = "padding:5px 5px;font-weight:600;border-radius:2rem;height:40%;color:white;width:80%;" })
            </div>
        </div>
        
    </div>

   
</div>


<script>
    $(document).ready(function () {
        var change = 0;
        var temp = @listtv[0].IDTV;
        var crbd = 100 / @listtv.Count();
        $(`.close-practice`).hide();
        responsiveVoice.speak($(`#` + temp).attr("class"), "UK English Female", { volume: 0.5,rate:0.75 });
        var sott = 1;
        $(`.amount`).children(".liquid").css("width", crbd + "%");
        $(`.learn-container`).children().children().children().children().children().children(".star").click(function () {
            if ($(this).css("color") == "rgb(255, 237, 38)") {
                console.log("true");
                $(this).css("color", " rgb(0, 0, 0)");
                $.get(`@Url.Action("removeWord", "vocabulary")`, { idtv: $(this).parent().parent().parent().attr("id"), idcd : @tuple.Item2 });
            }
            else {
                console.log("false");
                $(this).css("color", "rgb(255, 237, 38)");
                $.get(`@Url.Action("addWord", "vocabulary")`, { idtv: $(this).parent().parent().parent().attr("id"), idcd : @tuple.Item2 });
            }

        });




        $(`.sound`).click(function () {
            responsiveVoice.speak($(`#` + temp).attr("class"), "UK English Female", { volume: 0.5, rate: 0.75 });
        });
        $(`.previous-next`).children(".previous").hide();
        $(`.previous-next`).children(".next").click(function () {
            sott++;
            temp++;
            $(`.amount`).children(".liquid").css("width", crbd * sott + "%");
            $(`.info`).children("h3").text(sott + " / " +@listtv.Count());
            document.getElementById(temp).scrollIntoView();
            if (sott > 1) {
                $(`.previous-next`).children(".previous").show();
            }
            if (sott == @listtv.Count) {
                $(`.previous-next`).children(".next").hide();
                $(`.close-practice`).show();
            }
            setTimeout(speak, 250);


        });
        $(`.previous-next`).children(".previous").click(function () {
            sott--;
            temp--;
            $(`.amount`).children(".liquid").css("width", crbd * sott + "%");
            $(`.info`).children("h3").text(sott + " / " +@listtv.Count());
            document.getElementById(temp).scrollIntoView();
            if (sott == 1) {
                $(`.previous-next`).children(".previous").hide();
            }
            if (sott < @listtv.Count) {
                $(`.previous-next`).children(".next").show();
                $(`.close-practice`).hide();
            }
            setTimeout(speak, 250);
        });



        $(`.play-pause`).click(function () {
            change++;
            if (change % 2 == 1) {
                $(this).attr("src", "/Img/button/pause.png");
                if (sott < @listtv.Count) {
                    setTimeout(speak, 500);
                    var loop = setInterval(function () {
                        setTimeout(speak, 500);
                        sott++;
                        temp++;
                        $(`.amount`).children(".liquid").css("width", crbd * sott + "%");
                        $(`.info`).children("h3").text(sott + " / " +@listtv.Count());
                        document.getElementById(temp).scrollIntoView();
                        if (sott > 1) {
                            $(`.previous-next`).children(".previous").show();
                        }
                        if (sott == @listtv.Count) {
                            $(`.previous-next`).children(".next").hide();
                            $(`.play-pause`).attr("src", "/Img/button/start.png");
                            change++;
                            clearInterval(loop);
                            $(`.close-practice`).show();
                        }
                        else {
                            $(this).click(function () {
                                $(this).attr("src", "/Img/button/start.png");
                                clearInterval(loop);
                            });
                            $(`.stop`).click(function () {
                                clearInterval(loop);
                                sott=1;
                                temp=@listtv[0].IDTV;
                                $(`.amount`).children(".liquid").css("width", crbd * sott + "%");
                                $(`.info`).children("h3").text(sott + " / " +@listtv.Count());
                                document.getElementById(temp).scrollIntoView();
                                $(`.close-practice`).show();
                                $(`.play-pause`).attr("src", "/Img/button/start.png");
                                if (change % 2 == 0) {
                                    change == 0;
                                }
                                else {
                                    change++;
                                }

                            });
                        }
                    }, 2500);

                }

            }
            else {
                $(this).attr("src", "/Img/button/start.png");
            }

        });

        $(`.stop`).click(function () {
                                sott=1;
                                temp=@listtv[0].IDTV;
                                $(`.amount`).children(".liquid").css("width", crbd * sott + "%");
                                $(`.info`).children("h3").text(sott + " / " +@listtv.Count());
                                document.getElementById(temp).scrollIntoView();
                                $(`.close-practice`).show();
                                $(`.play-pause`).attr("src", "/Img/button/start.png");
                                if (change % 2 == 0) {
                                    change == 0;
                                }
                                else {
                                    change++;
                                }

                            });

        function speak() {
            responsiveVoice.speak($(`#` + temp).attr("class"), "UK English Female", { volume: 0.5, rate: 0.75 });
            $.get(`@Url.Action("addWord", "Exam")`, { });
        }

    });

</script>